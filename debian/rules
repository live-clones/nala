#!/usr/bin/make -f

%:
	set -x
	dh $@ --buildsystem=none

execute_before_dh_installman:
	pandoc docs/nala.8.md \
	--standalone \
	--from markdown \
	--to man | gzip -c > docs/nala.8.gz

execute_before_dh_install:
	mkdir -p debian/nala/usr/bin
	mv nala-cli.build/nala debian/nala/usr/bin/nala
	chrpath -d debian/nala/usr/bin/nala

override_dh_clean:
	rm -f nala.egg-info
	rm -f docs/nala.8.gz
	rm -rf nala-cli.build
	rm -rf nala/__pycache__
	dh_clean

override_dh_auto_build:
	nuitka3 --assume-yes-for-downloads \
	--follow-import-to=nala \
	--follow-import-to=pyshell \
	--follow-import-to=pythonping \
	--follow-import-to=rich \
	--plugin-enable=pylint-warnings \
	--static-libpython=yes \
	nala-cli.py -o nala-cli.build/nala
